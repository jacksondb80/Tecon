OS

--consulta de os pelo documento e com status de fatura
SELECT  ROWID
        ,NVL((SELECT CASE WHEN (PFT.STATUS IN (0,4,5)) THEN 'CN'
       WHEN PFT.STATUS = 1 THEN 'PF'
       WHEN PFT.STATUS = 2 THEN 'FT'  
       END AS STATUS_OSFAT
  FROM SC_FAT_PRE_FATURA_OS PFO
     , SC_FAT_PRE_FATURA PFT     
  WHERE PFT.FAT_PRE_FATURA_ID = PFO.FAT_PRE_FATURA_ID
        AND PFO.OS_ID             = A.OS_ID),'SP')
        ,A.* 
 FROM   ADMSCOL.SC_OS A WHERE A.SRF_DOCUMENTO_ID IN (SELECT A.ID FROM ADMSCOL.SRF_DOCUMENTO A WHERE A.DOCUMENTO IN ('21703404866','21703405005'))